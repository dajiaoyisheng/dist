webpackJsonp([5],{"82Sr":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("BO1k"),n=a.n(i),s=a("mvHQ"),o=a.n(s),r=(a("wa1j"),a("zeeE")),c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"showVideo"}},[e("iframe",{staticStyle:{height:"500px",width:"850px"},attrs:{src:"../ws_rtsp/rtspPlay.jsp?id="+this.cameraId}})])},staticRenderFns:[]},l={data:function(){return{files:[],downloadtURL:""}},methods:{initDatas:function(){this.files=[],this.downloadtURL=this.$store.state.env+this.urlconfig.cmDownloadTemplet},handleExceed:function(t,e){this.$message.warning("当前限制选择3个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},handleChange:function(t,e){this.files=e},submitUpload:function(){for(var t=this,e=this.files,a=new FormData,i=0;i<e.length;i++)a.append("importFile",e[i].raw);this.$fileUpload(this.urlconfig.cmImportCameras,a).then(function(e){0===e.status&&t.$message.success(e.statusinfo)}).catch(function(t){}).then(function(){})}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"importCameras"}},[a("section",{staticClass:"importSection"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("span",[t._v("只能上传xls/xlsx文件，且不超过2M")])])],1),t._v(" "),a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"importMeta"},[t._v("请选择导入文件:")])]),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"auto",limit:3,"on-exceed":t.handleExceed,"file-list":t.files,"on-change":t.handleChange,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[t._v("选择文件")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:t.submitUpload}},[t._v("上传到服务器")])],1)],1),t._v(" "),a("el-col",{attrs:{span:4}},[a("a",{staticClass:"importMeta",attrs:{href:t.downloadtURL,download:""}},[t._v("下载模板")])])],1)],1)])},staticRenderFns:[]};var u={components:{cameraVideo:a("VU/8")({props:["cameraId"]},c,!1,null,null,null).exports,importCameras:a("VU/8")(l,p,!1,function(t){a("tfEk")},"data-v-507e6816",null).exports,tablePagination:r.a},data:function(){return{prisonSubRegions:[],cameraTypes:[],count:0,cameraList:[],cameraId:null,isShowVideo:!1,isShowImport:!1,changeRow:[],current:null,tempRow:[],exportURL:"",params:{paiCode:"",ciType:"",ciName:"",nodeType:""}}},mounted:function(){this.initDatas(),this.getPrisonSubRegions(),this.getCameraTypes(),this.getCameraList()},methods:{initDatas:function(){this.exportURL=this.$store.state.env+this.urlconfig.cmExportCameras},getPrisonSubRegions:function(){var t=this;this.$get(this.urlconfig.cmGetPrisonSubRegions).then(function(e){0===e.status&&(t.prisonSubRegions=e.data)}).catch(function(t){}).then(function(){})},getCameraTypes:function(){var t=this;this.$get(this.urlconfig.cmGetCameraTypes).then(function(e){0===e.status&&(t.cameraTypes=e.data)}).catch(function(t){}).then(function(){})},getCameraList:function(){var t=this,e={pageIndex:this.$refs.pagination.index,pageSize:this.$refs.pagination.limit,params:o()(this.params)};this.$post(this.urlconfig.cmGetCameraList,e).then(function(e){0===e.status&&(t.tempRow=[],t.changeRow=[],t.current=null,t.count=e.data.totalRows,t.cameraList=e.data.items)}).catch(function(t){}).then(function(){})},saveCameraInfo:function(){var t=this,e={saveItems:o()(this.changeRow)};this.$post(this.urlconfig.cmSaveCameraInfo,e).then(function(e){0===e.status&&t.$message.success(e.statusinfo)}).catch(function(t){}).then(function(){})},showVideo:function(t,e){this.cameraId=e.ciId,this.isShowVideo=!0},beforeVideoClose:function(){this.cameraId=null,this.isShowVideo=!1},changePaiPathFilter:function(t){var e=this;this.params.paiCode=t[t.length-1],this.getCascaderObj(t,this.prisonSubRegions).map(function(t){e.params.nodeType=t.nodeType})},changePaiCode:function(t,e){this.tempRow=e,this.current=t},changePaiPathTable:function(t){var e=this,a=[],i=[];(i=this.getCascaderObj(t,this.prisonSubRegions)).map(function(t){a.push(t.label)}),this.cameraList.forEach(function(t){e.tempRow.ciId===t.ciId&&(t.paiPath=a.join("/"))});var n={};i.map(function(t){n={ciId:e.tempRow.ciId,paiCode:t.value}});var s=this.changeRow.findIndex(function(t){return t.ciId===e.tempRow.ciId});s>-1?this.changeRow[s]=n:this.changeRow.push(n)},getCascaderObj:function(t,e){return t.map(function(t){var a=!0,i=!1,s=void 0;try{for(var o,r=n()(e);!(a=(o=r.next()).done);a=!0){var c=o.value;if(c.value==t)return e=c.children,c}}catch(t){i=!0,s=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw s}}return null})},importCameras:function(){var t=this;this.isShowImport=!0,this.$nextTick(function(){t.$refs.importCameras.initDatas()})},beforeImportClose:function(){this.isShowImport=!1,this.getCameraList()}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"cameramanager"}},[a("p",{staticClass:"contentInfo"},[t._v("摄像头列表")]),t._v(" "),a("section",{staticClass:"contentMain"},[a("section",{staticClass:"puu-params"},[a("el-row",[a("el-col",{attrs:{span:7}},[a("span",[t._v("所在区域:")]),t._v(" "),a("el-cascader",{attrs:{size:"small","change-on-select":"",placeholder:"请选择",options:t.prisonSubRegions},on:{change:t.changePaiPathFilter}})],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",[t._v("摄像头类型:")]),t._v(" "),a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.params.ciType,callback:function(e){t.$set(t.params,"ciType",e)},expression:"params.ciType"}},t._l(t.cameraTypes,function(t){return a("el-option",{key:t.sCode,attrs:{label:t.sName,value:t.sCode}})}))],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",[t._v("摄像头编号/名称:")]),t._v(" "),a("el-input",{staticClass:"pp-input",attrs:{size:"small",placeholder:"请输入摄像头编号或名称",clearable:""},model:{value:t.params.ciName,callback:function(e){t.$set(t.params,"ciName",e)},expression:"params.ciName"}})],1),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"small"},on:{click:t.getCameraList}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"small"},on:{click:t.saveCameraInfo}},[t._v("保存")]),t._v(" "),a("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"small"},on:{click:t.importCameras}},[t._v("导入")]),t._v(" "),a("a",{staticClass:"search-btn exportButton",attrs:{href:t.exportURL,download:""}},[t._v("导出")])],1)],1)],1),t._v(" "),a("section",[a("el-dialog",{attrs:{title:"摄像头导入",visible:t.isShowImport,width:"500px","before-close":t.beforeImportClose},on:{"update:visible":function(e){t.isShowImport=e}}},[a("importCameras",{ref:"importCameras"})],1)],1),t._v(" "),a("section",[a("el-dialog",{attrs:{title:"实时视频",visible:t.isShowVideo,width:"900px","before-close":t.beforeVideoClose},on:{"update:visible":function(e){t.isShowVideo=e}}},[a("cameraVideo",{attrs:{cameraId:t.cameraId}})],1)],1),t._v(" "),a("section",{staticClass:"el-table-wrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.cameraList,stripe:""}},[a("el-table-column",{attrs:{prop:"paiPath",label:"所在区域","min-width":"200px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){t.changePaiCode(e.$index,e.row)}}},[a("el-cascader",{directives:[{name:"show",rawName:"v-show",value:t.current===e.$index,expression:"current === scope.$index"}],attrs:{"change-on-select":!0,placeholder:"请选择",options:t.prisonSubRegions},on:{blur:function(e){t.current=null},change:t.changePaiPathTable}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.current!==e.$index,expression:"current !== scope.$index"}]},[t._v(t._s(e.row.paiPath))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"ciId",label:"摄像头编号","min-width":"80px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ciName",label:"摄像头名称","min-width":"80px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ciType",label:"摄像头类型","min-width":"140px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ciNearid",label:"相邻摄像头","min-width":"140px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"realtimeUri",label:"实时视频服务地址","min-width":"140px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"replayUri",label:"回放视频服务地址","min-width":"140px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ciMemo",label:"备注","min-width":"120px",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"120px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),t.showVideo(e.$index,e.row)}}},[t._v("实时视频")])]}}])})],1),t._v(" "),a("div",{staticClass:"el-pagination-wrap"},[a("table-pagination",{ref:"pagination",attrs:{total:t.count},on:{change:t.getCameraList}})],1)],1)])])},staticRenderFns:[]};var m=a("VU/8")(u,h,!1,function(t){a("oSKT"),a("NW1Q")},"data-v-60660a15",null);e.default=m.exports},BO1k:function(t,e,a){t.exports={default:a("fxRn"),__esModule:!0}},NW1Q:function(t,e){},fxRn:function(t,e,a){a("+tPU"),a("zQR9"),t.exports=a("g8Ux")},g8Ux:function(t,e,a){var i=a("77Pl"),n=a("3fs2");t.exports=a("FeBl").getIterator=function(t){var e=n(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},oSKT:function(t,e){},tfEk:function(t,e){},wa1j:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABwUlEQVQ4T6WTvYsTQRjGn2cCkjVgp1gGO0HkrMVG8U8wIoLFFXJHJKiwM/H8YBQ07KwE9cSrBatUZ6Nwop12ovgPbEqv0EIlCybuK3PsLJcj8USn2pl939/79bzEfx7O8rfW7omiaEEpdUxElIi8z/P8o7X25077KYCIME1TKyJXAYxJfiodDovIXgAPtdY3SUoAVQDv7Jx7AmCR5P16vZ50Op1v3rDf70fj8fgyyesAnsVxvBwgFcA51wVwjeSJOI5D5KmMe73eIaXUOwCrxpi7/ucWYDAY1LIs2yR5W2u96t+cc8dJft8Jc86dFZG1PM8P+p5sAZIkOQXgRRRF+0PazrmnAM4DeNxoNG602+0fIdhwOPwK4IzWeiMALgFYMsYcCTmXgAvl/XNRFIvdbvdlGfANgHVjzKPtgIvGmKPzACKybIxZL8t7LSLPK0CapidFZGM0Gu2z1o5Ko7klZFn2xZdgjHk11UQAdzy1TPO0UmpzRhPP+b40m80DrVbrVzXGJEkMyZXdxlir1d76MWqt71Vj9B+7CWkymVwBsDJXSAHyJymTfBDH8a2ZUt4uubBMJBdIsiiKD3+1TP+y2b8BwGnyEWNMwNUAAAAASUVORK5CYII="}});
//# sourceMappingURL=5.6ebf358d38a95b9a4569.js.map